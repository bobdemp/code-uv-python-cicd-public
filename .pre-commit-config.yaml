# =============================================================================
# PRE-COMMIT HOOKS CONFIGURATION
# =============================================================================
# This file configures pre-commit hooks for code quality and consistency
# Install with: poetry run pre-commit install
# Run manually: poetry run pre-commit run --all-files
# =============================================================================
repos:
  # Ruff for .py files
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.7
    hooks:
      - id: ruff-check
        args: ["--fix"]
        files: \.py$
        description: "Lint and fix Python code (.py) with Ruff"
      - id: ruff-format
        files: \.py$
        description: "Format Python code (.py) with Ruff"
  # nbQA for notebooks
  - repo: https://github.com/nbQA-dev/nbQA
    rev: 1.9.1
    hooks:
      - id: nbqa
        name: nbqa-ruff
        entry: nbqa ruff --fix
        additional_dependencies: [ruff]
        types: [jupyter]
        description: "Lint and fix code cells in notebooks with Ruff"
      - id: nbqa
        name: nbqa-black
        entry: nbqa black
        additional_dependencies: [black==24.1.1]
        types: [jupyter]
        description: "Format code cells in notebooks with Black"
  # Types for Python
  - repo: https://github.com/RobertCraigie/pyright-python
    rev: v1.1.407
    hooks:
      - id: pyright
        additional_dependencies: [pytest,click]
  # Shell script linting
  - repo: https://github.com/koalaman/shellcheck-precommit
    rev: v0.11.0
    hooks:
      - id: shellcheck
        description: "Lint shell scripts with ShellCheck"
        files: \.(sh|bash)$
  # SQL linting with SQLFluff
  - repo: https://github.com/sqlfluff/sqlfluff
    rev: 4.0.0
    hooks:
      - id: sqlfluff-lint
        description: "Lint SQL files with SQLFluff"
      - id: sqlfluff-fix
        description: "Auto-fix SQL files with SQLFluff"
  # YAML validation and formatting
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: check-yaml
        description: "Validate YAML files"
      - id: end-of-file-fixer
        description: "Ensure files end with a newline"
      - id: trailing-whitespace
        description: "Remove trailing whitespace"
      - id: check-merge-conflict
        description: "Check for merge conflict markers"
      - id: check-added-large-files
        description: "Prevent large files from being committed"
        args: ['--maxkb=1000']
      - id: check-case-conflict
        description: "Check for case conflicts in filenames"
      - id: check-json
        description: "Validate JSON files"
      - id: pretty-format-json
        args: ['--autofix']
        description: "Format JSON files"
  # Security scanning
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        description: "Detect secrets in code"
        exclude: \.env\.template$
  - repo: https://github.com/astral-sh/uv-pre-commit
    # uv version.
    rev: 0.9.27
    hooks:
      - id: uv-lock
